<!DOCTYPE html>
<html>

  <head>
    <meta charset='utf-8'>
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <meta name="description" content="Secure multi-word passphrases generated in your browser">

    <link rel="stylesheet" type="text/css" media="screen" href="stylesheets/stylesheet.css">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <title>Passphrase Generator</title>
  </head>

  <body>

    <!-- HEADER -->
    <div id="header_wrap" class="outer">
        <header class="inner">
          <a id="forkme_banner" href="https://github.com/danstiner/password-generator">View on GitHub</a>

          <h1 id="project_title">Passphrase Generator</h1>
          <h2 id="project_tagline">Secure multi-word passphrases generated in your browser</h2>

          <script type="text/javascript" src="javascripts/wordlist-common-passwords.js"></script>
          <script type="text/javascript" src="javascripts/wordlist-diceware.js"></script>
          <script type="text/javascript" src="javascripts/main.js"></script>
          <script type="text/javascript">
          //<![CDATA[
          var wordlists = {
            "common-passwords": {
              description: "common words",
              words: wordlistCommonPasswords
            },
            "diceware": {
              description: "<a href=\"http://www.diceware.com/\">Diceware</a> words",
              words: wordlistDiceware
            }
          };
          var wordlist = wordlists[localStorage.getItem("wordlist")] || wordlists["common-passwords"]
          var wordCount = parseInt(localStorage.getItem("wordCount")) || 6;

          var onSelectWordCount = target => {
            wordCount = parseInt(target.dataset.value);
            localStorage.setItem("wordCount", wordCount);
            generatePassphrase(wordlist.words, wordCount);
            document.getElementById("passphrase_generation_symbol_count").innerHTML = target.innerHTML;
            return false;
          };
          var onSelectWordlist = target => {
            var wordlistName = target.dataset.value;
            wordlist = wordlists[wordlistName];
            localStorage.setItem("wordlist", wordlistName)
            generatePassphrase(wordlist.words, wordCount);
            document.getElementById("passphrase_generation_wordlist").innerHTML = wordlist.description;
            return false;
          };
          var updateSelectors = () => {
            document.getElementById("passphrase_generation_symbol_count").innerHTML = Array.from(document.querySelectorAll("#passphrase_generation_symbol_counts a")).filter(elem => elem.dataset.value == wordCount)[0].innerHTML;
            document.getElementById("passphrase_generation_wordlist").innerHTML = wordlist.description;
          };
          function selectNodeContents(element) {
            var range = document.createRange();
            range.selectNodeContents(element);
            var selection = window.getSelection();
            selection.removeAllRanges();
            selection.addRange(range);
          };
          window.onload = () => {
            updateSelectors();
            generatePassphrase(wordlist.words, wordCount);
          };
          //]]>
          </script>
        </header>
    </div>

    <!-- MAIN CONTENT -->
    <div id="main_content_wrap" class="outer">
      <section id="main_content" class="inner">
        <p>
          This phrase consists of
          <span class="dropdown">
            <span id="passphrase_generation_symbol_count" class="text-decoration-underline-dotted">six</span>
            <span class="dropdown-content" id="passphrase_generation_symbol_counts">
              <a href="#" onclick="return onSelectWordCount(this)" data-value=4>four</a>
              <a href="#" onclick="return onSelectWordCount(this)" data-value=5>five</a>
              <a href="#" onclick="return onSelectWordCount(this)" data-value=6>six</a>
              <a href="#" onclick="return onSelectWordCount(this)" data-value=7>seven</a>
            </span>
          </span> 
          random
          <span class="dropdown">
            <span id="passphrase_generation_wordlist" class="text-decoration-underline-dotted">common words</span><span>.</span>
            <span class="dropdown-content">
              <a href="#" onclick="return onSelectWordlist(this)" data-value="common-passwords">common&nbsp;words</a>
              <a href="#" onclick="return onSelectWordlist(this)" data-value="diceware">Diceware&nbsp;words</a>
            </span>
          </span>
          It should be easy to remember but hard to guess, making it a good password.
        </p>
        <div class="passphrase_block">
          <span id="generated_passphrase" onclick="selectNodeContents(this)" ></span><br>
          <span>
            <span id="time_to_guess_offline" data-rate=10000000000000></span>
            <span>at ten trillion guesses/sec</span>
          </span><br>
          <span id="generated_passphrase_entropy"></span><br>
          <span id="passphrase_generation_error" class="alert alert-danger" style="display:none"></span>
        </div>
        <br>
        <div id="comic">
          <span>Inspired by the following <a href="https://xkcd.com">xkcd</a> comic strip:</span>
          <a href="https://xkcd.com/936/">
            <img class="containwidth" src="https://imgs.xkcd.com/comics/password_strength.png" title="To anyone who understands information theory and security and is in an infuriating argument with someone who does not (possibly involving mixed case), I sincerely apologize." alt="Password Strength">
          </a>
        </div>
        <p>
          <h2>More information</h2>
          <ul>
            <li>All computation is done on the local computer's browser using javascript, no passphrase data is sent or received from any server</li>
            <li>Randomness comes from the cryptographically secure <a href="https://developer.mozilla.org/en-US/docs/Web/API/RandomSource/getRandomValues">getRandomValues</a> function</li>
            <li>Time to guess estimate assumes cracking a stolen hash of the passphrase and a nation-state level adversary. This is very conservative, but becomes more plausible as password data breaches keep happening and computers double in speed each year. Check if your existing passwords have been compromised at <a href="https://haveibeenpwned.com/">haveibeenpwned.com</a>
              <blockquote>
                Assume your adversary is capable of one trillion guesses per second.
                <footer>â€” Edward Snowden in 2014 via <a href="https://www.wired.com/2014/10/snowdens-first-emails-to-poitras/">WIRED</a></footer>
              </blockquote>
            </li>
            <li>Common word list contains 2075 words, derived from the <a href="https://github.com/danielmiessler/SecLists/tree/gmaster/Passwords">10,000 most common passwords</a> which were words in <a href="http://wordlist.aspell.net/12dicts-readme/#223cmn">a dictionary</a> but not <a href="http://www.bannedwordlist.com/">swear words</a> or proper nouns.</li>
            
            <li>Source code available in <a href="javascripts/main.js">main.js</a>. Code is purposefully simple to allow easy verification.</li>
          </ul>
        </p>
      </section>
    </div>

    <!-- FOOTER  -->
    <div id="footer_wrap" class="outer">
      <footer class="inner">
        <p class="copyright">Passphrase Generator maintained by <a href="//danielstiner.com">Daniel Stiner</a></p>
        <p>Published with <a href="https://pages.github.com">GitHub Pages</a></p>
      </footer>
    </div>

  </body>
</html>
